{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Брелоки — Welcome Dream</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .gallery-img {transition: opacity 0.4s; opacity:0; position:absolute; left:0; right:0;}
    .gallery-img.active {opacity:1; position:static;}
    .gallery-dots .active-dot {background: #1e3a8a;}
  </style>
</head>
<body class="bg-white text-gray-900">

  <!-- Шапка -->
<header class="bg-blue-900 text-white sticky top-0 z-40 shadow-lg">
    <div class="max-w-7xl mx-auto flex items-center justify-between p-4">
      <div class="flex items-center space-x-4">
        <img src="img/logo.svg" alt="Welcome Dream Logo" class="h-12">
      </div>
      <!-- Desktop Nav -->
      <nav class="space-x-6 hidden md:flex items-center relative">
        <!-- Выпадающее меню по hover -->
        <div class="relative group">
          <button class="hover:text-yellow-400 flex items-center focus:outline-none" type="button">
            Категории
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute left-0 mt-2 w-44 bg-white text-gray-800 rounded shadow-lg border z-50
                      opacity-0 group-hover:opacity-100 invisible group-hover:visible transition-all duration-200">
            <a href="#breloki" class="block px-4 py-2 hover:bg-blue-100">Брелоки</a>
            <a href="#podveski" class="block px-4 py-2 hover:bg-blue-100">Подвески</a>
            <a href="#braslety" class="block px-4 py-2 hover:bg-blue-100">Браслеты</a>
            <a href="#ruchki" class="block px-4 py-2 hover:bg-blue-100">Ручки</a>
            <a href="#nabory" class="block px-4 py-2 hover:bg-blue-100">Наборы</a>
          </div>
        </div>
        <a href="#engraving" class="hover:text-yellow-400">Гравировка</a>
        <a href="#about" class="hover:text-yellow-400">О нас</a>
        <a href="#contacts" class="hover:text-yellow-400">Контакты</a>
      </nav>
      <div class="flex items-center space-x-4">
        <input type="text" placeholder="Поиск" class="p-2 rounded hidden md:block" />
        <div class="relative">
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.2 6H17a1 1 0 001-1v-1M7 13l.4-2m5 5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm6 0a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" />
            </svg>
            <span class="absolute -top-1 -right-2 bg-red-600 text-xs text-white rounded-full px-1.5">0</span>
          </a>
        </div>
        <!-- Burger -->
        <button id="burger" class="burger flex flex-col justify-center md:hidden ml-2">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>
    <!-- Mobile Menu -->
    <nav id="mobileMenu" class="md:hidden bg-blue-800 text-white text-lg px-6 py-4 space-y-2 absolute w-full left-0 top-20 hidden z-50">
      <div>
        <button id="mobileCatBtn" class="flex items-center w-full text-left hover:text-yellow-400" type="button">
          Категории
          <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div id="dropdownMobile" class="ml-4 mt-2 space-y-1 hidden">
          <a href="#breloki" class="block px-2 py-1 hover:bg-blue-700 rounded">Брелоки</a>
          <a href="#podveski" class="block px-2 py-1 hover:bg-blue-700 rounded">Подвески</a>
          <a href="#braslety" class="block px-2 py-1 hover:bg-blue-700 rounded">Браслеты</a>
          <a href="#ruchki" class="block px-2 py-1 hover:bg-blue-700 rounded">Ручки</a>
          <a href="#nabory" class="block px-2 py-1 hover:bg-blue-700 rounded">Наборы</a>
        </div>
      </div>
      <a href="#engraving" class="block hover:text-yellow-400">Гравировка</a>
      <a href="#about" class="block hover:text-yellow-400">О нас</a>
      <a href="#contacts" class="block hover:text-yellow-400">Контакты</a>
    </nav>
  </header>

  <main>
    <section class="max-w-7xl mx-auto px-4 py-10">
      <h2 class="text-3xl font-semibold mb-6">Брелоки</h2>

      <!-- Сортировка -->
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4">
        <div></div>
        <div class="flex items-center space-x-2">
          <span class="text-gray-700">Сортировать:</span>
          <select id="sortSelect" class="border rounded px-3 py-1 focus:outline-none focus:ring focus:border-blue-400">
            <option value="price">Цена</option>
            <option value="date">Дата добавления</option>
            <option value="popularity">Популярность</option>
          </select>
        </div>
      </div>

      <!-- Сетка товаров -->
      <div id="brelok-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
        <!-- Товары добавляются скриптом -->
      </div>
    </section>
  </main>

  <!-- Кнопка "вверх" -->
  <button id="toTop" class="hidden fixed bg-yellow-400 text-white p-3 rounded-full shadow hover:bg-yellow-500 transition">
    &#8679;
  </button>

  <!-- Подвал -->
  <footer id="contacts" class="bg-blue-900 text-white text-sm py-6 mt-12">
    <div class="max-w-7xl mx-auto px-4 flex flex-col items-center space-y-2">
      <p>&copy; 2025 Welcome Dream. Все права защищены.</p>
      <p>Email: <span contenteditable="true">example@email.com</span> | Телефон: <span contenteditable="true">+7 999 999-99-99</span></p>
      <div class="flex space-x-4 mt-2">
        <a href="https://t.me/your_username" target="_blank" class="hover:opacity-75">
          <img src="img/telegram.svg" alt="Telegram" class="h-6">
        </a>
        <a href="https://wa.me/79999999999" target="_blank" class="hover:opacity-75">
          <img src="img/whatsapp.svg" alt="WhatsApp" class="h-6">
        </a>
        <a href="https://vk.com/your_username" target="_blank" class="hover:opacity-75">
          <img src="img/vk.svg" alt="VK" class="h-6">
        </a>
      </div>
    </div>
  </footer>

  <!-- Скрипт товаров, сортировки и галереи -->
  <script>
    const breloki = [
      {
        id: 1,
        title: "Брелок 'Сердце'",
        desc: "Металл, красная эмаль, идеален для подарка",
        price: 350,
        date: "2024-05-22",
        popularity: 132,
        images: [
          "img/brelok1-1.jpg",
          "img/brelok1-2.jpg",
          "img/brelok1-3.jpg"
        ]
      },
      {
        id: 2,
        title: "Брелок 'Авто'",
        desc: "Металл, черное покрытие, стильный дизайн",
        price: 390,
        date: "2024-05-20",
        popularity: 115,
        images: [
          "img/brelok2-1.jpg",
          "img/brelok2-2.jpg"
        ]
      },
      {
        id: 3,
        title: "Брелок 'Котик'",
        desc: "Акрил, милый подарок для детей и взрослых",
        price: 320,
        date: "2024-05-18",
        popularity: 90,
        images: [
          "img/brelok3-1.jpg",
          "img/brelok3-2.jpg"
        ]
      },
      {
        id: 4,
        title: "Брелок металлический",
        desc: "Прочный, можно нанести индивидуальную гравировку",
        price: 280,
        date: "2024-05-15",
        popularity: 101,
        images: [
          "img/brelok4-1.jpg"
        ]
      }
      // Добавь свои товары ниже по аналогии!
    ];

    // Рендер карточек с мини-галереей
    function renderBreloki(list) {
      const container = document.getElementById('brelok-list');
      container.innerHTML = '';
      list.forEach((item, idx) => {
        const galleryId = `gallery-${idx}`;
        let imagesHtml = '';
        let dotsHtml = '';
        item.images.forEach((src, i) => {
          imagesHtml += `
            <img src="${src}" alt="${item.title} фото ${i+1}"
              class="gallery-img${i===0 ? ' active' : ''} mx-auto h-24 object-contain"
              style="max-width:100px; ${i!==0 ? 'display:none;' : ''}">
          `;
          dotsHtml += `
            <button type="button" onclick="galleryDot('${galleryId}', ${i})" class="w-3 h-3 rounded-full bg-blue-200${i===0 ? ' active-dot' : ''}"></button>
          `;
        });

        container.innerHTML += `
          <div class="border rounded p-4 text-center transition hover:scale-105 hover:shadow-lg bg-white">
            <div class="relative w-full mb-2 flex items-center justify-center" style="height:120px;">
              <div class="w-full relative" style="height:100px;" id="${galleryId}">
                ${imagesHtml}
                ${item.images.length > 1 ? `
                <button type="button" class="absolute top-1/2 left-0 -translate-y-1/2 px-2 bg-white bg-opacity-80 rounded-full shadow z-10"
                  onclick="galleryPrev('${galleryId}')">&#8592;</button>
                <button type="button" class="absolute top-1/2 right-0 -translate-y-1/2 px-2 bg-white bg-opacity-80 rounded-full shadow z-10"
                  onclick="galleryNext('${galleryId}')">&#8594;</button>
                ` : ''}
              </div>
            </div>
            <div class="flex justify-center gallery-dots space-x-2 mb-2">
              ${dotsHtml}
            </div>
            <p>${item.title}</p>
            <p class="text-sm text-gray-500 mb-1">${item.desc}</p>
            <p class="font-bold">${item.price} ₽</p>
            <button class="mt-2 bg-blue-900 text-white py-1 px-4 rounded hover:bg-blue-700">В корзину</button>
          </div>
        `;
      });
    }

    // Сортировка
    function sortBreloki(list, criterion) {
      let arr = [...list];
      if (criterion === "price") arr.sort((a, b) => a.price - b.price);
      else if (criterion === "date") arr.sort((a, b) => new Date(b.date) - new Date(a.date));
      else if (criterion === "popularity") arr.sort((a, b) => b.popularity - a.popularity);
      return arr;
    }

    // Мини-галерея
    function galleryPrev(id) {
      const gallery = document.getElementById(id);
      const imgs = gallery.querySelectorAll('.gallery-img');
      let current = Array.from(imgs).findIndex(img => img.classList.contains('active'));
      imgs[current].classList.remove('active');
      imgs[current].style.display = "none";
      const dots = gallery.parentElement.parentElement.querySelectorAll('.gallery-dots button');
      if(dots[current]) dots[current].classList.remove('active-dot');
      current = (current - 1 + imgs.length) % imgs.length;
      imgs[current].classList.add('active');
      imgs[current].style.display = "block";
      if(dots[current]) dots[current].classList.add('active-dot');
    }
    function galleryNext(id) {
      const gallery = document.getElementById(id);
      const imgs = gallery.querySelectorAll('.gallery-img');
      let current = Array.from(imgs).findIndex(img => img.classList.contains('active'));
      imgs[current].classList.remove('active');
      imgs[current].style.display = "none";
      const dots = gallery.parentElement.parentElement.querySelectorAll('.gallery-dots button');
      if(dots[current]) dots[current].classList.remove('active-dot');
      current = (current + 1) % imgs.length;
      imgs[current].classList.add('active');
      imgs[current].style.display = "block";
      if(dots[current]) dots[current].classList.add('active-dot');
    }
    function galleryDot(id, idx) {
      const gallery = document.getElementById(id);
      const imgs = gallery.querySelectorAll('.gallery-img');
      const dots = gallery.parentElement.parentElement.querySelectorAll('.gallery-dots button');
      imgs.forEach((img,i)=>{
        img.classList.toggle('active', i===idx);
        img.style.display = i===idx ? "block" : "none";
      });
      dots.forEach((btn,i)=>btn.classList.toggle('active-dot',i===idx));
    }

    // Инициализация
    document.addEventListener('DOMContentLoaded', () => {
      const select = document.getElementById('sortSelect');
      renderBreloki(sortBreloki(breloki, select.value));
      select.addEventListener('change', () => {
        renderBreloki(sortBreloki(breloki, select.value));
      });
    });
  </script>
</body>
</html>